#### JPA의 ddl-auto 옵션
ddl-auto 옵션은 **애플리케이션이 실행될 때 데이터베이스 스키마를 어떻게 관리할지 결정하는 설정**이다.  
DDL은 Data Definition Language의 약자다. 데이터베이스 스키마를 정의 및 변경하는 SQL 문을 의미한다.

- **DDL 주요 명령어**
  - CREATE:	테이블, 뷰, 인덱스 등을 생성
  - ALTER:	기존 테이블 구조 수정 (컬럼 추가, 수정 등)
  - DROP:	테이블, 뷰, 인덱스 등을 삭제
  - TRUNCATE:	테이블의 모든 데이터를 삭제 (구조는 유지)

ddl-auto 옵션을 설정해서 **데이터 정의 언어(DDL)를 자동으로 실행**하는 것이다.  
JPA 구현체인 **Hibernate가 엔티티 클래스 기반으로 데이터베이스 스키마를 자동 생성하거나 변경하는 동작을 제어**한다.

application.properties 또는 application.yml 파일에서 설정할 수 있고, none, validate, update, create, create-drop 등의 옵션이 존재한다.


#### 스키마
데이터베이스의 구조(구성 요소)를 정의한 것을 의미한다.
테이블, 컬럼, 제약 조건, 관계 등이 포함된다.
```sql
CREATE TABLE users (
    id INT PRIMARY KEY,         -- 기본 키 (PK)
    name VARCHAR(50) NOT NULL,  -- 이름 (NULL 허용 X)
    email VARCHAR(100) UNIQUE,  -- 이메일 (중복 X)
    created_at TIMESTAMP        -- 생성 날짜
);
```
위 SQL에서 users 테이블의 구조(컬럼, 제약 조건 등)를 스키마라고 한다.



#### JPA의 ddl-auto 옵션은 각각 어떤 동작을 하고 어떤 상황에 사용해야 할까?
- **none**
  - 데이터베이스 스키마와 관련된 어떠한 작업도 수행하지 않는다. 데이터베이스 스키마를 수동으로 관리하고 싶을 때 유용하며, 프로덕션 환경에서 주로 사용한다.

- **update**
  - 엔티티 매핑과 데이터베이스 스키마를 비교하여 필요한 경우 스키마를 업데이트한다. 기존 데이터는 유지되지만, 새로운 엔티티나 변경된 엔티티 필드는 스키마에 반영된다. 엔티티에 변경이 발생할 때 자동으로 스키마를 업데이트하고 싶을 때 유용하다. 프로덕션 환경에서는 예기치 않은 스키마 변경을 방지하기 위해 주의가 필요하다.

- **create**
  - 애플리케이션 시작 시 기존 스키마를 삭제하고 새로 생성한다. 데이터가 모두 삭제되며 엔티티 매핑을 기반으로 새로운 스키마가 생성된다. 개발 초기에 빈 데이터베이스 스키마를 반복적으로 생성해야 할 때 유용하다. 기존 데이터가 모두 삭제되므로 프로덕션 환경에서는 사용하지 않는다.

- **create-drop**
  - create와 유사하지만, 애플리케이션이 종료될 때 스키마를 삭제한다는 점이 다르다. 테스트 환경에서 일시적인 데이터베이스 스키마가 필요한 경우 유용하며, 매 테스트 실행 시마다 깨끗한 데이터베이스 상태를 유지하고자 할 때 사용한다. 프로덕션 환경에서는 사용하지 않는다.

- **validate**
  - 애플리케이션이 시작될 때, 엔티티 매핑이 데이터베이스 스키마와 일치하는지 검증하며 스키마 변경은 따로 수행하지 않는다. 프로덕션 환경에서 엔티티와 데이터베이스 스키마가 일치하는지 확인하고 싶을 때 사용한다.




#### 프로덕션 환경에서 스키마 변경이 필요하면 어떻게 해야 할까?
적절한 데이터베이스 마이그레이션 도구(Flyway, Liquibase 등)를 사용하여 제어된 방식으로 스키마를 관리하거나, 모니터링을 통해 트래픽이 가장 낮은 시간대를 분석해서 스키마 변경 작업을 수동으로 진행하는 것이 안전할 수 있다.
